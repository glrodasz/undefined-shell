---
import { getLocaleFromAstro } from "../i18n/config";

interface Props {
  date: Date;
  leadingComma?: boolean;
  locale?: string;
}

const { date, leadingComma, locale } = Astro.props;

const currentLocale = getLocaleFromAstro({ ...Astro, props: { locale } });

const titleCase = (str: string) =>
  str.charAt(0).toLocaleUpperCase(currentLocale) +
  str.slice(1).toLocaleLowerCase();

const formatDate = (date: Date, locale: string) => {
  const parts = date
    .toLocaleDateString(locale, {
      year: "numeric",
      month: "short",
      day: "numeric",
    })
    .split(" ");

  if (parts.length >= 3) {
    parts[1] = titleCase(parts[1]);
  }

  return parts.join(" ");
};
---

<time datetime={date.toISOString()}>
  {formatDate(date, currentLocale)}{leadingComma ? " â€¢" : ""}
</time>
